INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100001,20160001,500,5,2500,'A001',TIMESTAMP'2016-01-01 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100001,20160002,1000,4,4000,'A002',TIMESTAMP'2016-01-01 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100001,20160003,500,3,1500,'A008',TIMESTAMP'2016-01-01 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100002,20160004,2000,1,2000,'A004',TIMESTAMP'2016-01-02 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100002,20160005,500,1,500,'A001',TIMESTAMP'2016-01-03 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100003,20160006,1500,2,3000,'A003',TIMESTAMP'2016-01-03 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100004,20160007,500,2,1000,'A001',TIMESTAMP'2016-01-04 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100004,20160008,300,1,300,'A005',TIMESTAMP'2016-01-04 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100004,20160009,600,1,600,'A006',TIMESTAMP'2016-01-04 00:00:00');
INSERT INTO MONEY_TBL_02 (CUSTNO,SALENOL,PCOST,AMOUNT,PRICE,PCODE,SDATE) VALUES (100004,20160010,3000,1,3000,'A007',TIMESTAMP'2016-01-06 00:00:00');

SELECT mt.CUSTNO , CUSTNAME, decode(grade,'A','VIP','B','일반','C','직원') AS agrade,
	asum FROM MEMBER_TBL_02 mt , (SELECT custno, sum(price) AS asum FROM MONEY_TBL_02 mt  
	GROUP BY CUSTNO ORDER BY asum desc) sale
	WHERE mt.CUSTNO = sale.custno order by ASUM DESC ;